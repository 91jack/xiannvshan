<!doctype html>
<html class="no-js">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
  <title>地图搜索</title>
  <link rel="stylesheet" href="static/css/common.css">
  <link rel="stylesheet" type="text/css" href="static/css/swiper-4.3.3.min.css"/>
  <link rel="stylesheet" href="static/css/app.css">
  <style type="text/css">

  	body {
  		position: relative;
  		background: #fff;

  	}
#nav {
	height: 3.333333rem;
	padding: 0 0.833333rem;
}
.swiper-slide {
	margin-right: .5rem;
}
.swiper-slide span{
	font-size: 1.25rem;
	line-height:3.333333rem;
	color:#999;
}
#nav .bar {
	width:2.083333rem;
	height:0.125rem;
	position:absolute;
	bottom:0px;
}
#nav .bar .color {
	width:1.5rem;
	margin:0 auto;
	height:0.125rem;
	background:#0BBE06;
}
  	
.search-result {
	width:100%;
	position: absolute;
	bottom: 1rem;
	
}
.search-result ul {
	width: 29.5rem;
	margin: 0 auto;
}
.search-result li {
	width: 27.5rem;
	height:5.333333rem;
	background: #fff;
	border-radius: 0.416666rem;
	border:1px solid #e5e5e5;
	margin-bottom: 1rem;
	padding: 1rem;
}
.search-result li .left {
	float:left;
	
}
.search-result li .left h3 {
	font-size: 1.25rem;
	color: #333;
	line-height: 1.5rem;
}
.search-result li .left p {
	font-size: 1rem;
	line-height: 1.5rem;
	color: #999;
}
.search-result li .left p:last-child {
	color:#22C41E;
}
  </style>
</head>
<body class="">
	<div class="mask"></div>
	<!--搜索-->
	<div class="top-search clearfix">
		<div class="container">
			<input type="text" placeholder="搜索感兴趣内容"/>
			<img src="static/images/icon_search.png"/>
			<a href="javascript:;">搜索</a>
		</div>
	</div>
	


        
   <div class="swiper-container" id="nav">
    <div class="swiper-wrapper">
      <div class="swiper-slide" data-selectval='0'>
        <span style="color:#0BBE06;">全部展示</span>
      </div>
      <div class="swiper-slide" data-selectval='1'>
        <span>必看景点</span>
      </div>
      <div class="swiper-slide" data-selectval='2'>
        <span>康养医疗</span>
      </div>
      <div class="swiper-slide" data-selectval='3'>
        <span>酒店民宿</span>
      </div>
      <div class="swiper-slide" data-selectval='4'>
        <span>农业采摘</span>
      </div>
      <div class="swiper-slide" data-selectval='5'>
        <span>政府服务</span>
      </div>
      <div class="swiper-slide" data-selectval='6'>
        <span>统战馆</span>
      </div>
      
      <!--<div class="bar">
        <div class="color"></div>
      </div>-->
    </div>
  </div>
        

	
	<div id="map"></div>
	
	<div class="search-result">
		<ul>
			<li>
				<div class="left">
					<h3>鸿运酒店</h3>
					<p>1.7公里|重庆市武隆区赵家乡113号</p>
					<p>营业时间：9:00-17:00</p>
					<p>房间优惠：9.8折</p>
				</div>
				<div class="right">
					
				</div>
			</li>
			<li>
				<div class="left">
					<h3>鸿运酒店</h3>
					<p>1.7公里|重庆市武隆区赵家乡113号</p>
					<p>营业时间：9:00-17:00</p>
					<p>房间优惠：9.8折</p>
				</div>
				<div class="right">
					
				</div>
			</li>
		</ul>
	</div>
	
<script src="static/js/jquery-3.1.1.min.js"></script>
<script src="static/js/common.js"></script>
<script src="static/js/swiper-4.3.3.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="https://api.map.baidu.com/api?v=2.0&ak=wqB7npvF7DsDGlFG2oYhih93K5iEqsou"></script>
<script type="text/javascript">
	// 地图高度
	var clientHeight = window.screen.height;
	$('#map').css('height',clientHeight-168 + 'px');
	
	//暂时设计每个slide大小需要一致
  barwidth = 36 //导航粉色条的长度px
  tSpeed = 300 //切换速度300ms
  var navSwiper = new Swiper('#nav', {
  	slidesPerView: 4,
  	freeMode: true,
  	on: {
  		init: function() {
  			navSlideWidth = this.slides.eq(2).css('width'); //导航字数需要统一,每个导航宽度一致
  			bar = this.$el.find('.bar')
  			bar.css('width', navSlideWidth)
  			bar.transition(tSpeed)
  			navSum = this.slides[this.slides.length - 1].offsetLeft //最后一个slide的位置

  			clientWidth = parseInt(this.$wrapperEl.css('width')) //Nav的可视宽度
  			navWidth = 0
  			for (i = 0; i < this.slides.length; i++) {
  				navWidth += parseInt(this.slides.eq(i).css('width'))
  			}

  			topBar = this.$el.parents('body').find('#top') //页头

  		},
  	},
  });


  navSwiper.$el.on('touchstart', function(e) {
  	e.preventDefault() //去掉按压阴影
  })
  navSwiper.on('tap', function(e) {

  	clickIndex = this.clickedIndex
  	clickSlide = this.slides.eq(clickIndex)
 
  	this.slides.find('span').css('color', 'rgba(51,51,51,1)');
  	clickSlide.find('span').css('color', '#0BBE06');
  	
  	// 输出tab对应的值
  	console.log(clickSlide.attr('data-selectval'))
  	
  	// 后台ajax
  	
  })

	
	
	
// 地图初始化
var map = new BMap.Map("map"); // 创建Map实例
var point = new BMap.Point(107.562695,29.271674);//赵家乡政府
map.centerAndZoom(point, 15); // 初始化地图,设置中心点坐标和地图级别

map.enableScrollWheelZoom(true); // 缩放地图


//获取两点距离，保留小数点后两位
//var pointA = new BMap.Point(106.486654,29.490295);  // 创建点坐标A--大渡口区
//var pointB = new BMap.Point(106.581515,29.615467);  // 创建点坐标B--江北区
//alert('从大渡口区到江北区的距离是：'+(map.getDistance(pointA,pointB)).toFixed(2)+' 米。');  //获取两点距离,保留小数点后两位
//var polyline = new BMap.Polyline([pointA,pointB], {strokeColor:"blue", strokeWeight:6, strokeOpacity:0.5});  //定义折线
//map.addOverlay(polyline);     //添加折线到地图上

//添加控件和比例尺
var top_right_navigation = new BMap.NavigationControl({anchor: BMAP_ANCHOR_TOP_RIGHT, type: BMAP_NAVIGATION_CONTROL_SMALL}); //右上角
map.addControl(top_right_navigation);    

// 设置点的新图标
var myIcon = new BMap.Icon("static/mapicon/icon_zzf.png", new BMap.Size(100,100));
var marker2 = new BMap.Marker(point,{icon:myIcon});  // 创建标注
map.addOverlay(marker2); 

var iconArr = [
	{type:'all',icon:'static/mapicon/icon_jiudian.png'}
];

// 添加多个点
function addMarker(point){
	  var marker = new BMap.Marker(point,{icon:jingquIcon});
	  map.addOverlay(marker);
	}

	// 随机向地图添加25个标注
	var jingquIcon = new BMap.Icon("static/mapicon/icon_jiudian.png", new BMap.Size(50,50));
	var bounds = map.getBounds();
	var sw = bounds.getSouthWest();
	var ne = bounds.getNorthEast();
	var lngSpan = Math.abs(sw.lng - ne.lng);
	var latSpan = Math.abs(ne.lat - sw.lat);
	for (var i = 0; i < 25; i ++) {
		var point = new BMap.Point(sw.lng + lngSpan * (Math.random() * 0.7), ne.lat - latSpan * (Math.random() * 0.7));
		addMarker(point);
	}


//var arr =[];
//// 当前定位
//var geolocation = new BMap.Geolocation();
//geolocation.getCurrentPosition(function(r) {
//	if(this.getStatus() == BMAP_STATUS_SUCCESS) {
//		var geoc = new BMap.Geocoder();
//			geoc.getLocation(r.point, function(rs) {
//				console.log(r.point)
//				var addComp = rs.addressComponents;
//				var address = addComp.city + addComp.district + addComp.street + addComp.streetNumber;
//				console.log(address);
//				
//				localStorage.setItem('addr',address);
//				localStorage.setItem('address_xy',JSON.stringify(r.point))
//			})
//		position(r);
//		deletePoint();
//	} else {
//		alert('failed' + this.getStatus());
//	}
//});
//
//
//function showInfo(e) {
//	position(e);
//	deletePoint();
//}
//map.addEventListener("click", showInfo);
//
//var geolocation = new BMap.Geolocation();
//geolocation.getCurrentPosition(function(r) {
//	if(this.getStatus() == BMAP_STATUS_SUCCESS) {
//		var geoc = new BMap.Geocoder();
//		geoc.getLocation(r.point, function(rs) {
//			console.log(r.point)
//			var addComp = rs.addressComponents;
//			var address = addComp.city + addComp.district + addComp.street + addComp.streetNumber;
//			console.log(address);
//			$('.icon').click(function(e){
//				var mk = new BMap.Marker(e.point);
//				mk.point= new BMap.Point(r.point.lng, r.point.lat)
//				arr.push(mk);
//				map.addOverlay(mk);
//				map.panTo(mk.point);
//				// 逆地址解析
//				var geoc = new BMap.Geocoder();
//				geoc.getLocation(mk.point, function(rs) {
//					var addComp = rs.addressComponents;
//					var address = addComp.city + addComp.district + addComp.street + addComp.streetNumber;
//					addr.innerHTML = address;
//				})
//				p = mk.point;
//				console.log(p);
//				deletePoint();
//			})
//		})
//	} else {
//		alert('failed' + this.getStatus());
//	}
//});
//
//function position(e) {
//	var mk = new BMap.Marker(e.point);
//	arr.push(mk);
//	map.addOverlay(mk);
//	map.panTo(e.point);
//	// 逆地址解析
//	var geoc = new BMap.Geocoder();
//	geoc.getLocation(e.point, function(rs) {
//		var addComp = rs.addressComponents;
//		var address = addComp.city + addComp.district + addComp.street + addComp.streetNumber;
//		//addr.innerHTML = address;
//	})
//	p = e.point;
//	console.log(p);
//	$('.BMap_geolocationIcon').on('click',function(){
//		console.log(1111111111)
//	})
//	// 存json
//	
//	localStorage.setItem('address_xy',JSON.stringify(e.point))
//}
//function deletePoint(){
//	var allOverlay = map.getOverlays();
//	for (var i = 0; i < arr.length-1; i++){
//		map.removeOverlay(allOverlay[i+1]);
//		return false;
//	}
//}
	
</script>
</body>
</html>